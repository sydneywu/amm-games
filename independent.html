<html>
<body>

<script>
	window.addEventListener('message', (msg)=>{
		console.log('received message', msg.data)
	})

	var prizeConfig = [
    {
      "id": 1,
      "prizeType": 1,
      "code": "T-shirt",
      "winRate": 0.25,
      "maxRewardable": 10,
      "requireStockAvailable": false
    },
    {
      "id": 2,
      "prizeType": 1,
      "code": "Evoucher",
      "winRate": 0.25,
      "maxRewardable": 10,
      "requireStockAvailable": false
    },
    {
      "id": 3,
      "prizeType": 2,
      "code": "Food",
      "winRate": 0.25,
      "maxRewardable": 10,
      "requireStockAvailable": false
    },
    {
      "id": 4,
      "prizeType": 3,
      "code": "Books",
      "winRate": 0.25,
      "maxRewardable": 10,
      "requireStockAvailable": false
    }
  ]

  var slices = []

  var totalProbability = prizeConfig.reduce((acc , curr)=>{
    return acc + curr.winRate 
  }, 0)

  prizeConfig.forEach((prize,i)=>{
    var prize = {
        id: prize.id,
        degrees: prize.winRate/totalProbability * 360,
        text: prize.code
    }
    slices.push(prize);
  })


  let dataSrc = {
    slices: slices,
    wheelRounds: 4,
    winId: 2,
    winMessage: "Congratulations! You won Evoucher"
  }

  let dataString = JSON.stringify(dataSrc)

  var iframeSource = 'http://localhost:8080/wheel/circle2?data='+dataString;
  var iframe = document.createElement('iframe');
  iframe.setAttribute('src', iframeSource);
  iframe.setAttribute('id', 'the_iframe');
  iframe.setAttribute('width', 1000);
  iframe.setAttribute('height', 600);
  iframe.setAttribute('frameBorder', 0);

  document.body.appendChild(iframe);
</script>

</body>
</html>